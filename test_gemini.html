<!DOCTYPE html>
<html>
<head>
    <title>Teste Gemini API - DIAGN√ìSTICO DEFINITIVO</title>
    <style>
        body{font-family:Arial;padding:20px;background:#1a1a1a;color:#fff}
        .result{background:#2a2a2a;padding:15px;margin:10px 0;border-left:4px solid #00ff00;border-radius:4px}
        .error{border-left-color:#ff0000}
        button{padding:10px 20px;background:#00ff00;color:#000;border:none;cursor:pointer;font-weight:bold;margin:5px}
        h1{color:#00ff00}
        code{background:#000;padding:2px 6px;border-radius:3px}
    </style>
</head>
<body>
    <h1>üîç DIAGN√ìSTICO GEMINI API</h1>
    <p>Clique nos bot√µes para testar diferentes endpoints e modelos:</p>
    
    <button onclick="testV1()">Testar v1/models</button>
    <button onclick="testV1Beta()">Testar v1beta/models</button>
    <button onclick="testGenerateV1()">Testar generateContent v1</button>
    <button onclick="testGenerateV1Beta()">Testar generateContent v1beta</button>
    
    <div id="results"></div>

    <script>
        const API_KEY = 'AIzaSyCVMsuZDHBKs2lcIL9qlQK3ePQ5MOuTPok';
        const resultsDiv = document.getElementById('results');

        function log(message, isError = false) {
            const div = document.createElement('div');
            div.className = 'result' + (isError ? ' error' : '');
            div.innerHTML = message;
            resultsDiv.appendChild(div);
        }

        async function testV1() {
            log('üîÑ Testando v1/models...');
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1/models?key=${API_KEY}`);
                const data = await response.json();
                if (response.ok) {
                    log(`‚úÖ V1 FUNCIONA! Modelos dispon√≠veis: <code>${data.models?.map(m => m.name).join(', ')}</code>`);
                } else {
                    log(`‚ùå V1 ERROR: ${JSON.stringify(data)}`, true);
                }
            } catch (e) {
                log(`‚ùå V1 EXCEPTION: ${e.message}`, true);
            }
        }

        async function testV1Beta() {
            log('üîÑ Testando v1beta/models...');
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${API_KEY}`);
                const data = await response.json();
                if (response.ok) {
                    log(`‚úÖ V1BETA FUNCIONA! Modelos dispon√≠veis: <code>${data.models?.map(m => m.name).join(', ')}</code>`);
                } else {
                    log(`‚ùå V1BETA ERROR: ${JSON.stringify(data)}`, true);
                }
            } catch (e) {
                log(`‚ùå V1BETA EXCEPTION: ${e.message}`, true);
            }
        }

        async function testGenerateV1() {
            log('üîÑ Testando v1 generateContent com gemini-pro...');
            try {
                const response = await fetch('https://generativelanguage.googleapis.com/v1/models/gemini-pro:generateContent?key=' + API_KEY, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        contents: [{parts:[{text:"Diga apenas 'OK'"}]}]
                    })
                });
                const data = await response.json();
                if (response.ok) {
                    log(`‚úÖ GENERATE V1 FUNCIONA! Resposta: <code>${JSON.stringify(data).substring(0,200)}</code>`);
                } else {
                    log(`‚ùå GENERATE V1 ERROR: ${JSON.stringify(data)}`, true);
                }
            } catch (e) {
                log(`‚ùå GENERATE V1 EXCEPTION: ${e.message}`, true);
            }
        }

        async function testGenerateV1Beta() {
            log('üîÑ Testando v1beta generateContent com gemini-pro...');
            try {
                const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=' + API_KEY, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        contents: [{parts:[{text:"Diga apenas 'OK'"}]}]
                    })
                });
                const data = await response.json();
                if (response.ok) {
                    log(`‚úÖ GENERATE V1BETA FUNCIONA! Resposta: <code>${JSON.stringify(data).substring(0,200)}</code>`);
                } else {
                    log(`‚ùå GENERATE V1BETA ERROR: ${JSON.stringify(data)}`, true);
                }
            } catch (e) {
                log(`‚ùå GENERATE V1BETA EXCEPTION: ${e.message}`, true);
            }
        }

        // Auto-run all tests
        window.onload = async () => {
            await testV1();
            await new Promise(r => setTimeout(r, 1000));
            await testV1Beta();
            await new Promise(r => setTimeout(r, 1000));
            await testGenerateV1();
            await new Promise(r => setTimeout(r, 1000));
            await testGenerateV1Beta();
        };
    </script>
</body>
</html>
